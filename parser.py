import datetime
import re
import xml.etree.ElementTree as ET

from openpyxl.reader.excel import load_workbook

from Contact import Contact
from Config.config import TEMPLATE_FILE_XLSX, PAGE_NAME, LastName_column, FirstName_column, Email_column, Exam_column, \
    Date_column, \
    Hour_column, Minute_column, FirstNameEng_column, LastNameEng_column, Proctor_column, Password_column


def get_all_exam(xml: str) -> dict:
    root = ET.fromstring(xml)
    courses: dict = {}
    list_courses = []
    for i, group1 in enumerate(root.findall('contentItem')):
        _ = group1.find('contentItemId').text
        list_courses.append({group1.find('title').text: group1.find('contentItemId').text})
    for course_dict in list_courses:
        course_name = list(course_dict.keys())[0]
        if course_name in list(courses.keys()):
            courses[course_name].append(course_dict[course_name])
        else:
            courses[course_name] = [course_dict[course_name]]

    return courses


def get_all_users(xml: str) -> list[dict]:
    """

    :rtype: object
    """
    root = ET.fromstring(xml)
    users: list[dict] = []
    for i, group1 in enumerate(root.findall('userProfile')):
        # print(group1.find('userId').text)
        users.append({'userId': group1.find('userId').text})
        for group2 in group1.findall('fields'):
            for group3 in group2.findall('field'):
                # print(group3.find('name').text)
                # print(group3.find('value').text)
                users[i].update({group3.find('name').text: group3.find('value').text})
    return users


def clean_export_excel(s):
    s = s.replace(',', ', ')
    # Очистка текста от двойных пробелов
    s = re.sub(r'\s{2,}', ' ', s)
    s = s.strip()
    if s in ('None', '#N/A'):
        s = ''
    return s


def read_excel(excel, column, row):
    sheet_ranges = excel[PAGE_NAME]
    return str(sheet_ranges[f'{column}{row}'].value)


def get_contact_from_excel(filename=TEMPLATE_FILE_XLSX) -> list[Contact]:
    file_excel = load_workbook(filename=filename, data_only=True)
    users = []
    i = 1
    while i < 1000:
        i += 1
        user = Contact()

        user.lastName = clean_export_excel(read_excel(file_excel, column=LastName_column, row=i)).capitalize().strip()
        if user.lastName == '':
            continue
        user.firstName = clean_export_excel(read_excel(file_excel, column=FirstName_column, row=i)).capitalize().strip()
        user.email = clean_export_excel(read_excel(file_excel, column=Email_column, row=i)).lower().strip()
        user.password = clean_export_excel(read_excel(file_excel, column=Password_column, row=i)).strip()

        user.exam = clean_export_excel(read_excel(file_excel, column=Exam_column, row=i)).strip()

        user.date_from_file = clean_export_excel(read_excel(file_excel, column=Date_column, row=i)).lower().strip()

        hour = int(clean_export_excel(read_excel(file_excel, column=Hour_column, row=i)).lower())
        minute = int(clean_export_excel(read_excel(file_excel, column=Minute_column, row=i)).lower())

        user.firstNameEng = clean_export_excel(
            read_excel(file_excel, column=FirstNameEng_column, row=i)).capitalize().strip()
        user.lastNameEng = clean_export_excel(
            read_excel(file_excel, column=LastNameEng_column, row=i)).capitalize().strip()
        user.proctor = clean_export_excel(read_excel(file_excel, column=Proctor_column, row=i)).lower().strip()
        t = user.date_from_file
        t = re.sub(r'[^\d.]', '', t)
        t = t.split('.')
        t = list(map(int, t))
        # 2023-02-02T13:29:31Z

        # contact.dateExam = datetime.datetime(2023, 5, 13, hour, minute)
        year = t[2]
        month = t[1]
        day = t[0]
        user.dateExam = datetime.datetime(year=year, month=month, day=day, hour=hour, minute=minute)

        if user.normalize():
            users.append(user)
    return users


if __name__ == '__main__':
    xml = """<?xml version="1.0" encoding="UTF-8"?>
    <response><userProfile><userId>0c4110b4-4316-11ed-acc3-6e86b924614f</userId><role>studio_author</role><roleId>2d4afb76-3ef8-11ed-b0be-4ed85e011f68</roleId><departmentId>3b873b9a-3ef8-11ed-9e92-2a2de57b541b</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Результаты</value></field><field><name>FIRST_NAME</name><value>Экзаменов</value></field><field><name>LOGIN</name><value>ispringlearn</value></field><field><name>EMAIL</name><value>ispringlearn@itexpert.ru</value></field><field><name>PHONE</name><value>+79299680854</value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value>176</value></field><field><name>NAME_ENG</name><value></value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2022-10-03</addedDate><userRoles><userRole><roleId>2d4afb76-3ef8-11ed-b0be-4ed85e011f68</roleId><roleType>studio_author</roleType></userRole><userRole><roleId>eaf01662-2ae1-11e9-aa24-0242ac13000a</roleId><roleType>administrator</roleType><manageableDepartmentIds><id>39b4ad3e-3ef8-11ed-969d-2a2de57b541b</id></manageableDepartmentIds></userRole></userRoles><lastLoginDate>2023-02-27</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>0de13664-825a-11ed-90f5-02d444ba1ab7</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Норенко</value></field><field><name>FIRST_NAME</name><value>Юлия</value></field><field><name>LOGIN</name><value>Norenko_Julia</value></field><field><name>EMAIL</name><value>julia.norenko@akzonobel.com</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value></value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2022-12-23</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>1a6b0384-8259-11ed-811f-8a8776e69d21</id></groups><lastLoginDate>2022-12-23</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>0dfad600-825a-11ed-a36d-02d444ba1ab7</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Косолапов</value></field><field><name>FIRST_NAME</name><value>Сергей</value></field><field><name>LOGIN</name><value>Kosolapov_Sergey</value></field><field><name>EMAIL</name><value>qwezzt@gmail.com</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value></value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2022-12-23</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>1a6b0384-8259-11ed-811f-8a8776e69d21</id></groups><lastLoginDate>2022-12-23</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>0e0115c4-825a-11ed-be68-02d444ba1ab7</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Сычев</value></field><field><name>FIRST_NAME</name><value>Сергей</value></field><field><name>LOGIN</name><value>Sychev_Sergey</value></field><field><name>EMAIL</name><value>sychev_sa@nlmk.com</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value></value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2022-12-23</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>1a6b0384-8259-11ed-811f-8a8776e69d21</id></groups><lastLoginDate>2022-12-23</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>0e06aade-825a-11ed-af8d-02d444ba1ab7</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Привезенцев</value></field><field><name>FIRST_NAME</name><value>Иван</value></field><field><name>LOGIN</name><value>Privezentsev_Ivan</value></field><field><name>EMAIL</name><value>mskspartak14@gmail.com</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value></value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2022-12-23</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>1a6b0384-8259-11ed-811f-8a8776e69d21</id></groups><lastLoginDate>2022-12-23</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>0e0c3fd0-825a-11ed-8b33-02d444ba1ab7</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Утченко</value></field><field><name>FIRST_NAME</name><value>Андрей</value></field><field><name>LOGIN</name><value>Utchenko_Andrey</value></field><field><name>EMAIL</name><value>andrey.utchenko@itglobal.com</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value></value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2022-12-23</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>1a6b0384-8259-11ed-811f-8a8776e69d21</id></groups><lastLoginDate>2022-12-23</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>0e120564-825a-11ed-801d-02d444ba1ab7</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Семин</value></field><field><name>FIRST_NAME</name><value>Дмитрий</value></field><field><name>LOGIN</name><value>Semin_Dmitriy</value></field><field><name>EMAIL</name><value>dmitriy.semin@itglobal.com</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value></value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2022-12-23</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>1a6b0384-8259-11ed-811f-8a8776e69d21</id></groups><lastLoginDate>2022-12-23</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>0e177fd0-825a-11ed-b62e-02d444ba1ab7</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Шарыгин</value></field><field><name>FIRST_NAME</name><value>Александр</value></field><field><name>LOGIN</name><value>Sharigin_Alexandr</value></field><field><name>EMAIL</name><value>alexandr.sharigin@itglobal.com</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value></value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2022-12-23</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>1a6b0384-8259-11ed-811f-8a8776e69d21</id></groups><lastLoginDate>2022-12-23</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>0e1d7d86-825a-11ed-a8db-02d444ba1ab7</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Снегирева</value></field><field><name>FIRST_NAME</name><value>Ирина</value></field><field><name>LOGIN</name><value>Snegireva_Irina</value></field><field><name>EMAIL</name><value>irsnegireva@gmail.com</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value></value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2022-12-23</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>bee07228-8259-11ed-ba69-3ef864d67fd2</id></groups><lastLoginDate>2022-12-23</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>29027c52-b778-11ed-84e5-1e10cb612e18</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Полещук</value></field><field><name>FIRST_NAME</name><value>Анастасия</value></field><field><name>LOGIN</name><value>Anastasiya_Poleshchuk</value></field><field><name>EMAIL</name><value>a.poleshchuk@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Anastasiya Poleshchuk</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-28</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>c8dc8e26-b777-11ed-af60-12e0bb433d81</id></groups><lastLoginDate>2023-03-01</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>291bc55e-b778-11ed-8c88-1e10cb612e18</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Овчаренко</value></field><field><name>FIRST_NAME</name><value>Алексей</value></field><field><name>LOGIN</name><value>Alexey_Ovcharenko</value></field><field><name>EMAIL</name><value>a.ovcharenko@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Alexey Ovcharenko</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-28</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>c8dc8e26-b777-11ed-af60-12e0bb433d81</id></groups><lastLoginDate>2023-03-01</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>29252edc-b778-11ed-8853-1e10cb612e18</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Корниенко</value></field><field><name>FIRST_NAME</name><value>Анастасия</value></field><field><name>LOGIN</name><value>Anastasiya_Kornienko</value></field><field><name>EMAIL</name><value>a.kornienko@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Anastasiya Kornienko</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-28</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>c8dc8e26-b777-11ed-af60-12e0bb433d81</id></groups><lastLoginDate>2023-03-01</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>37687b5c-b9c1-11ed-9c38-3e061674d8b2</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>АААСавушкин</value></field><field><name>FIRST_NAME</name><value>АААГригорий</value></field><field><name>LOGIN</name><value>Savushkin_Grigorii</value></field><field><name>EMAIL</name><value>sav.gv@bk.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value></value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-03-03</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>39bf61fc-3ef8-11ed-aff2-2a2de57b541b</userId><role>studio_author</role><roleId>2d4afb76-3ef8-11ed-b0be-4ed85e011f68</roleId><departmentId>3b873b9a-3ef8-11ed-9e92-2a2de57b541b</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Owner</value></field><field><name>FIRST_NAME</name><value>Павел</value></field><field><name>LOGIN</name><value>p.livcha@inncloud.ru</value></field><field><name>EMAIL</name><value>p.livcha@inncloud.ru</value></field><field><name>PHONE</name><value>+79269680854</value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value></value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2022-09-28</addedDate><userRoles><userRole><roleId>2d4afb76-3ef8-11ed-b0be-4ed85e011f68</roleId><roleType>studio_author</roleType></userRole><userRole><roleId>eaefe76e-2ae1-11e9-b90a-0242ac13000a</roleId><roleType>owner</roleType><manageableDepartmentIds><id>39b4ad3e-3ef8-11ed-969d-2a2de57b541b</id></manageableDepartmentIds></userRole></userRoles><lastLoginDate>2023-03-03</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>3c82bb3c-ade8-11ed-a612-a6dff054abe0</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Сапегин</value></field><field><name>FIRST_NAME</name><value>Степан</value></field><field><name>LOGIN</name><value>Stepan_Sapegin</value></field><field><name>EMAIL</name><value>s.sapegin@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Stepan Sapegin</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-16</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>22ab4508-ade8-11ed-b840-029b622ed66c</id></groups><lastLoginDate>2023-02-16</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>6e86947e-b90e-11ed-95d4-62831c5f8ce3</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Горбач</value></field><field><name>FIRST_NAME</name><value>Игорь</value></field><field><name>LOGIN</name><value>Gorbach_Igor</value></field><field><name>EMAIL</name><value>igorbach@ibs.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Gorbach Igor</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-03-02</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>0a41e3ea-a920-11ed-90d9-625c16bd7ad5</id></groups><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>ac031c6c-aeca-11ed-8bf4-1a2f0e40a535</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Карлов</value></field><field><name>FIRST_NAME</name><value>Антон</value></field><field><name>LOGIN</name><value>Anton_Karlov</value></field><field><name>EMAIL</name><value>a.karlov@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Anton Karlov</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-17</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>910b1ed2-aeca-11ed-b4e4-cafb982bfb8f</id><id>111afef4-b762-11ed-8c17-d6b992f37506</id></groups><lastLoginDate>2023-03-01</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>ac1cfb46-aeca-11ed-8890-1a2f0e40a535</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Евстигнеева</value></field><field><name>FIRST_NAME</name><value>Надежда</value></field><field><name>LOGIN</name><value>Nadezhda_Evstigneeva</value></field><field><name>EMAIL</name><value>n.evstigneeva@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Nadezhda Evstigneeva</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-17</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>910b1ed2-aeca-11ed-b4e4-cafb982bfb8f</id></groups><lastLoginDate>2023-02-20</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>ac24ada0-aeca-11ed-ba32-1a2f0e40a535</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Трифонова</value></field><field><name>FIRST_NAME</name><value>Анастасия</value></field><field><name>LOGIN</name><value>Anastasiya_Trifonova</value></field><field><name>EMAIL</name><value>a.trifonova@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Anastasiya Trifonova</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-17</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>910b1ed2-aeca-11ed-b4e4-cafb982bfb8f</id></groups><lastLoginDate>2023-02-20</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>bf0259c0-b219-11ed-9d4c-5a27dab657a9</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Крутцова</value></field><field><name>FIRST_NAME</name><value>Анастасия</value></field><field><name>LOGIN</name><value>Anastasiya_Krutcova</value></field><field><name>EMAIL</name><value>a.krutcova@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Anastasiya Krutcova</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-21</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>ac8369e2-b219-11ed-83f7-7e2ca9127b51</id></groups><lastLoginDate>2023-02-22</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>bf1a7b0e-b219-11ed-8eba-5a27dab657a9</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Рогачева</value></field><field><name>FIRST_NAME</name><value>Алевтина</value></field><field><name>LOGIN</name><value>Alevtina_Rogacheva</value></field><field><name>EMAIL</name><value>a.rogacheva@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Alevtina Rogacheva</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-21</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>ac8369e2-b219-11ed-83f7-7e2ca9127b51</id></groups><lastLoginDate>2023-02-22</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>bf20e5de-b219-11ed-926f-5a27dab657a9</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Борхварт</value></field><field><name>FIRST_NAME</name><value>Анна</value></field><field><name>LOGIN</name><value>Anna_Borkhvart</value></field><field><name>EMAIL</name><value>a.borkhvart@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Anna Borkhvart</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-21</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>ac8369e2-b219-11ed-83f7-7e2ca9127b51</id><id>111afef4-b762-11ed-8c17-d6b992f37506</id></groups><lastLoginDate>2023-03-01</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>bf288456-b219-11ed-a1b2-5a27dab657a9</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Свиридов</value></field><field><name>FIRST_NAME</name><value>Сергей</value></field><field><name>LOGIN</name><value>Sergey_Sviridov</value></field><field><name>EMAIL</name><value>s.sviridov@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Sergey Sviridov</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-21</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>ac8369e2-b219-11ed-83f7-7e2ca9127b51</id></groups><lastLoginDate>2023-02-22</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>bf2ff146-b219-11ed-a8bb-5a27dab657a9</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Козин</value></field><field><name>FIRST_NAME</name><value>Денис</value></field><field><name>LOGIN</name><value>Denis_Kozin</value></field><field><name>EMAIL</name><value>d.kozin@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Denis Kozin</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-21</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>ac8369e2-b219-11ed-83f7-7e2ca9127b51</id></groups><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>c1983aac-5688-11ed-be58-ca90891feed7</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value></value></field><field><name>FIRST_NAME</name><value></value></field><field><name>LOGIN</name><value>ProctorEdu</value></field><field><name>EMAIL</name><value>ProctorEdu@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value></value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2022-10-28</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><lastLoginDate>2023-03-03</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>c26b9aa8-b76a-11ed-ba4c-1e10cb612e18</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Глухова</value></field><field><name>FIRST_NAME</name><value>Владислава</value></field><field><name>LOGIN</name><value>Vladislava_Gluhova</value></field><field><name>EMAIL</name><value>v.gluhova@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value></value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-28</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>111afef4-b762-11ed-8c17-d6b992f37506</id></groups><lastLoginDate>2023-03-01</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>c2c1a224-44d6-11ed-9945-3a6bac6405ef</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Махонина</value></field><field><name>FIRST_NAME</name><value>Валентина</value></field><field><name>LOGIN</name><value>makhonina111</value></field><field><name>EMAIL</name><value>makhonina111@gmail.com</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Makhonina Valentina</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2022-10-05</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><lastLoginDate>2022-10-06</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>f8e2680c-b119-11ed-bbe1-9e0ed3a2d38b</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Андрющенко</value></field><field><name>FIRST_NAME</name><value>Диана</value></field><field><name>LOGIN</name><value>Diana_Andrjushhenko</value></field><field><name>EMAIL</name><value>d.andrjushhenko@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Diana Andrjushhenko</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-20</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>51fa14ce-b117-11ed-9acf-ba55aaf48de5</id></groups><lastLoginDate>2023-02-21</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>f901625c-b119-11ed-87a2-9e0ed3a2d38b</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Волошина</value></field><field><name>FIRST_NAME</name><value>Ирина</value></field><field><name>LOGIN</name><value>Irina_Voloshina</value></field><field><name>EMAIL</name><value>i.voloshina@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Irina Voloshina</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-20</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>51fa14ce-b117-11ed-9acf-ba55aaf48de5</id><id>44c2eb44-a6b0-11ed-97b6-4a22af111ea0</id></groups><lastLoginDate>2023-03-01</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>f90d9608-b119-11ed-ab45-9e0ed3a2d38b</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Рашева</value></field><field><name>FIRST_NAME</name><value>Марина</value></field><field><name>LOGIN</name><value>Marina_Rasheva</value></field><field><name>EMAIL</name><value>m.rasheva@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Marina Rasheva</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-20</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>51fa14ce-b117-11ed-9acf-ba55aaf48de5</id><id>111afef4-b762-11ed-8c17-d6b992f37506</id></groups><lastLoginDate>2023-03-02</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>f917f1f2-b119-11ed-8328-9e0ed3a2d38b</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Ким</value></field><field><name>FIRST_NAME</name><value>Никита</value></field><field><name>LOGIN</name><value>Nikita_Kim</value></field><field><name>EMAIL</name><value>n.kim@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Nikita Kim</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-20</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>51fa14ce-b117-11ed-9acf-ba55aaf48de5</id></groups><lastLoginDate>2023-02-21</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile><userProfile><userId>f9206dd2-b119-11ed-b8b0-9e0ed3a2d38b</userId><role>learner</role><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><departmentId>2745eb28-449c-11ed-8def-3ea1876893eb</departmentId><status>1</status><fields><field><name>LAST_NAME</name><value>Звездин</value></field><field><name>FIRST_NAME</name><value>Артем</value></field><field><name>LOGIN</name><value>Artem_Zvezdin</value></field><field><name>EMAIL</name><value>a.zvezdin@itexpert.ru</value></field><field><name>PHONE</name><value></value></field><field><name>JOB_TITLE</name><value></value></field><field><name>COUNTRY</name><value></value></field><field><name>NAME_ENG</name><value>Artem Zvezdin</value></field><field><name>ABOUT_ME</name><value></value></field></fields><addedDate>2023-02-20</addedDate><userRoles><userRole><roleId>eaf02558-2ae1-11e9-8b17-0242ac13000a</roleId><roleType>learner</roleType></userRole></userRoles><groups><id>51fa14ce-b117-11ed-9acf-ba55aaf48de5</id></groups><lastLoginDate>2023-02-22</lastLoginDate><subordination><subordinationType>inherit</subordinationType></subordination><coSubordination><subordinationType>inherit</subordinationType></coSubordination></userProfile></response>
    """
    users = get_all_users(xml)
    print(users[2])
